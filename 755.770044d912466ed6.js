"use strict";(self.webpackChunkatm_mangment=self.webpackChunkatm_mangment||[]).push([[755],{7755:(E,D,c)=>{c.r(D),c.d(D,{ListOfContractComponent:()=>J});var b=c(6283),t=c(5879),d=c(6814),u=c(7285),C=c(4238),l=c(6223),g=c(8431);class A{constructor(){this.createUserId=1,this.imageFile="",this.bankDataId="",this.contractStartDate=`${(new Date).getUTCFullYear()}-${(new Date).getUTCMonth()+1}-${(new Date).getDate()}`,this.contractEndDate=`${(new Date).getUTCFullYear()}-${(new Date).getUTCMonth()+1}-${(new Date).getDate()}`,this.contractValue=0,this.counterAtm=0,this.description="",this.startDateMdule={day:(new Date).getDate(),month:(new Date).getUTCMonth()+1,year:(new Date).getUTCFullYear()},this.endDateMdule={day:(new Date).getDate()+10,month:(new Date).getUTCMonth()+1,year:(new Date).getUTCFullYear()}}}var Z=c(6828),M=c(3740),v=c(7588),_=c(882),p=c(3999);function x(r,h){1&r&&(t.TgZ(0,"p",20),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&r&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"required")," "))}const S=function(r){return{"ng-error":r}};let f=(()=>{class r{constructor(){this.title="Add new ATM",this.id="",this.bankContract=null,this.bankId="",this.isView=!1,this.formData=new A,this.activeModal=(0,t.f3M)(u.Kz),this.contractService=(0,t.f3M)(C.U),this.userService=(0,t.f3M)(_.K),this.userData=null,this.contractImage=null,this.userService.getUserData().subscribe(e=>{this.userData=e})}ngOnInit(){this.bankContract&&(this.contractImage=this.bankContract.imageUrl,this.bankContract.startDateMdule={day:parseInt(this.bankContract.contractStartDate.slice(8,10)),month:parseInt(this.bankContract.contractStartDate.slice(5,7)),year:parseInt(this.bankContract.contractStartDate.slice(0,4))},this.bankContract.endDateMdule={day:parseInt(this.bankContract.contractEndDate.slice(8,10)),month:parseInt(this.bankContract.contractEndDate.slice(5,7)),year:parseInt(this.bankContract.contractEndDate.slice(0,4))},this.formData=this.bankContract)}saveData(){this.id.length>0?this.updateData():this.addNewData()}addNewData(){let e=new FormData;e.append("ImageFile",this.formData.imageFile),e.append("CreateUserId",this.userData?this.userData?.UserId.toString():""),e.append("BankDataId",this.bankId),e.append("ContractStartDate",this.formData.contractStartDate),e.append("ContractEndDate",this.formData.contractEndDate),e.append("ContractValue",this.formData.contractValue.toString()),e.append("CounterAtm",this.formData.counterAtm.toString()),e.append("Description",this.formData.description),this.contractService.createContract(e).subscribe(a=>{a&&this.activeModal.close(!0)})}updateData(){let e=new FormData;e.append("ImageFile",this.formData.imageFile),e.append("Modifiedby",this.userData?this.userData?.UserId.toString():""),e.append("BankDataId",this.bankId),e.append("ContractStartDate",this.formData.contractStartDate),e.append("ContractEndDate",this.formData.contractEndDate),e.append("ContractValue",this.formData.contractValue.toString()),e.append("CounterAtm",this.formData.counterAtm.toString()),e.append("Description",this.formData.description),this.contractService.updateData(this.id,e).subscribe(a=>{a&&this.activeModal.close(!0)})}getData(){}static#t=this.\u0275fac=function(a){return new(a||r)};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-add-update-contract"]],inputs:{title:"title",id:"id",bankContract:"bankContract",bankId:"bankId",isView:"isView"},standalone:!0,features:[t.jDz],decls:37,vars:49,consts:[[1,"row","m-0","p-3"],[1,"col-9"],[1,"col-3","text-end","pt-2"],[1,"fa-solid","fa-xmark","text-danger","fs-4","pointer",3,"click"],[1,"p-3",3,"ngSubmit"],["atmForm","ngForm"],[1,"row"],[1,"col-12","col-md-6"],[3,"label","currentForm","ngbDateStruct","disabled","CurentDate"],[3,"label","ngbDateStruct","currentForm","disabled","CurentDate"],["ngDefaultControl","",3,"inputType","name","label","required","ngModel","currentForm","inputText","disabled","ngModelChange"],["companyName","ngModel"],[1,"col-12","py-3"],["for","",1,"required"],["ngDefaultControl","",1,"form-control",3,"name","required","ngModel","disabled","ngClass","ngModelChange"],["description","ngModel"],["class","text-danger",4,"ngIf"],[3,"curentImage","SelectImage"],[1,"col-12","text-end"],["type","submit",1,"btn","btn-dark","btn-md","shadow-lg","mt-3","col-3",3,"disabled"],[1,"text-danger"]],template:function(a,n){if(1&a){const o=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"h3"),t._uU(3),t.qZA()(),t.TgZ(4,"div",2)(5,"i",3),t.NdJ("click",function(){return n.activeModal.dismiss()}),t.qZA()()(),t.TgZ(6,"form",4,5),t.NdJ("ngSubmit",function(){t.CHM(o);const i=t.MAs(7);return t.KtG(i.valid&&n.saveData())}),t.TgZ(8,"div",6)(9,"div",7)(10,"app-date-input",8),t.NdJ("CurentDate",function(i){return n.formData.contractStartDate=i}),t.ALo(11,"translate"),t.qZA()(),t.TgZ(12,"div",7)(13,"app-date-input",9),t.NdJ("CurentDate",function(i){return n.formData.contractEndDate=i}),t.ALo(14,"translate"),t.qZA()()(),t.TgZ(15,"div",6)(16,"div",7)(17,"app-input-number-only",10,11),t.NdJ("ngModelChange",function(i){return n.formData.contractValue=i}),t.ALo(19,"translate"),t.qZA()(),t.TgZ(20,"div",7)(21,"app-input-number-only",10,11),t.NdJ("ngModelChange",function(i){return n.formData.counterAtm=i}),t.ALo(23,"translate"),t.qZA()(),t.TgZ(24,"div",12)(25,"label",13),t._uU(26),t.ALo(27,"translate"),t.qZA(),t.TgZ(28,"textarea",14,15),t.NdJ("ngModelChange",function(i){return n.formData.description=i}),t.qZA(),t.YNc(30,x,3,3,"p",16),t.qZA(),t.TgZ(31,"div",7)(32,"app-input-image",17),t.NdJ("SelectImage",function(i){return n.formData.imageFile=i}),t.qZA()(),t.TgZ(33,"div",18)(34,"button",19),t._uU(35),t.ALo(36,"translate"),t.qZA()()()()}if(2&a){const o=t.MAs(7),s=t.MAs(29);t.xp6(3),t.Oqu(n.title),t.xp6(7),t.Q6J("label",t.lcZ(11,35,"contracts.startDate"))("currentForm",o)("ngbDateStruct",n.formData.startDateMdule)("disabled",n.isView),t.xp6(3),t.Q6J("label",t.lcZ(14,37,"contracts.endDate"))("ngbDateStruct",n.formData.endDateMdule)("currentForm",o)("disabled",n.isView),t.xp6(4),t.Q6J("inputType","number")("name","ATMValue")("label",t.lcZ(19,39,"contracts.atmValue"))("required",!0)("ngModel",n.formData.contractValue)("currentForm",o)("inputText",n.formData.contractValue.toString())("disabled",n.isView),t.xp6(4),t.Q6J("inputType","number")("name","ContractValue")("label",t.lcZ(23,41,"contracts.contractValue"))("required",!0)("ngModel",n.formData.counterAtm)("currentForm",o)("inputText",n.formData.counterAtm.toString())("disabled",n.isView),t.xp6(5),t.Oqu(t.lcZ(27,43,"contracts.description")),t.xp6(2),t.Q6J("name","description")("required",!0)("ngModel",n.formData.description)("disabled",n.isView)("ngClass",t.VKq(47,S,(null==s.errors?null:s.errors.required)&&(o.submitted||s.touched))),t.xp6(2),t.Q6J("ngIf",(null==s.errors?null:s.errors.required)&&(o.submitted||s.touched)),t.xp6(2),t.Q6J("curentImage",n.contractImage),t.xp6(2),t.Q6J("disabled",n.isView),t.xp6(1),t.hij(" ",t.lcZ(36,45,"actions.save")," ")}},dependencies:[d.ez,d.mk,d.O5,l.u5,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.On,l.F,g.A0,Z.d,M.Y,v.y,p.aw,p.X$]})}return r})();var k=c(3103),I=c(1778);let L=(()=>{class r{constructor(){this.title="ConfirmationsCon",this.message="Are you sure you want chang this order status?",this.activeModal=(0,t.f3M)(u.Kz)}static#t=this.\u0275fac=function(a){return new(a||r)};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-confirms-contracts-alert"]],inputs:{title:"title",message:"message"},standalone:!0,features:[t.jDz],decls:19,vars:12,consts:[[1,"row","m-0","p-3"],[1,"col-9"],[1,"col-3","text-end","pt-2"],[1,"fa-solid","fa-xmark","text-danger","fs-4","pointer",3,"click"],[1,"p-3"],[1,"row"],[1,"text-end"],[1,"btn","btn-danger","m-2",3,"click"],[1,"btn","btn-primary","m-2",3,"click"]],template:function(a,n){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h3"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"div",2)(6,"i",3),t.NdJ("click",function(){return n.activeModal.dismiss()}),t.qZA()()(),t.TgZ(7,"div",4)(8,"div",5)(9,"p"),t._uU(10),t.ALo(11,"translate"),t.qZA()(),t.TgZ(12,"div",6)(13,"button",7),t.NdJ("click",function(){return n.activeModal.close(!0)}),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"button",8),t.NdJ("click",function(){return n.activeModal.dismiss()}),t._uU(17),t.ALo(18,"translate"),t.qZA()()()),2&a&&(t.xp6(3),t.Oqu(t.lcZ(4,4,"confirmAlertsCon.title")),t.xp6(7),t.Oqu(t.lcZ(11,6,"confirmAlertsCon.message")),t.xp6(4),t.hij(" ",t.lcZ(15,8,"confirmAlertsCon.confirm")," "),t.xp6(3),t.hij(" ",t.lcZ(18,10,"confirmAlertsCon.cancel")," "))},dependencies:[d.ez,p.aw,p.X$]})}return r})();var y=c(3519),w=c.n(y);function U(r,h){if(1&r){const e=t.EpF();t.TgZ(0,"ng-select",17,18),t.NdJ("clear",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.dataTable=[])})("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.selectedBankId=n)})("change",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.searchForData())}),t.ALo(2,"translate"),t.qZA()}if(2&r){const e=t.oxw();t.Q6J("clearable",!0)("name","city")("items",e.listOfBanks)("ngModel",e.selectedBankId)("required",!0)("searchable",!0)("notFoundText",t.lcZ(2,7,"contracts.noDataFound"))}}function F(r,h){if(1&r&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&r){const e=h.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e))}}const m=function(r){return{"background-color":r}};function q(r,h){if(1&r){const e=t.EpF();t.TgZ(0,"tr")(1,"td",20),t._uU(2),t.qZA(),t.TgZ(3,"td",20),t._uU(4),t.ALo(5,"date"),t.qZA(),t.TgZ(6,"td",20),t._uU(7),t.ALo(8,"date"),t.qZA(),t.TgZ(9,"td",20),t._uU(10),t.qZA(),t.TgZ(11,"td",20),t._uU(12),t.ALo(13,"number"),t.qZA(),t.TgZ(14,"td",20),t._uU(15),t.qZA(),t.TgZ(16,"td",21)(17,"div",22)(18,"div",23),t._UZ(19,"i",24),t.TgZ(20,"div",25)(21,"button",26),t.NdJ("click",function(){const o=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.viewDataTable(o))}),t._UZ(22,"i",27),t._uU(23),t.ALo(24,"translate"),t.qZA(),t.TgZ(25,"button",26),t.NdJ("click",function(){const o=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.updateDataTable(o))}),t._UZ(26,"i",28),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.TgZ(29,"button",26),t.NdJ("click",function(){const o=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.openCofirmDelete(o.contractId))}),t._UZ(30,"i",29),t._uU(31),t.ALo(32,"translate"),t.qZA()()()()()()}if(2&r){const e=h.$implicit,a=h.index,n=t.oxw();t.xp6(1),t.Q6J("ngStyle",t.VKq(31,m,n.isLessThanMonth(e)?"#f4d3d3a6":n.isExpired(e)?"red":"")),t.xp6(1),t.hij(" ",a+1," "),t.xp6(1),t.Q6J("ngStyle",t.VKq(33,m,n.isLessThanMonth(e)?"#f4d3d3a6":n.isExpired(e)?"red":"")),t.xp6(1),t.hij(" ",t.xi3(5,16,e.contractStartDate,"yyyy/MM/dd")," "),t.xp6(2),t.Q6J("ngStyle",t.VKq(35,m,n.isLessThanMonth(e)?"#f4d3d3a6":n.isExpired(e)?"red":"")),t.xp6(1),t.hij(" ",t.xi3(8,19,e.contractEndDate,"yyyy/MM/dd")," "),t.xp6(2),t.Q6J("ngStyle",t.VKq(37,m,n.isLessThanMonth(e)?"#f4d3d3a6":n.isExpired(e)?"red":"")),t.xp6(1),t.hij(" ",e.counterAtm," "),t.xp6(1),t.Q6J("ngStyle",t.VKq(39,m,n.isLessThanMonth(e)?"#f4d3d3a6":n.isExpired(e)?"red":"")),t.xp6(1),t.hij(" ",t.xi3(13,22,e.contractValue,".2")," "),t.xp6(2),t.Q6J("ngStyle",t.VKq(41,m,n.isLessThanMonth(e)?"#f4d3d3a6":n.isExpired(e)?"red":"")),t.xp6(1),t.hij(" ",e.description," "),t.xp6(1),t.Q6J("ngStyle",t.VKq(43,m,n.isLessThanMonth(e)?"#f4d3d3a6":n.isExpired(e)?"red":"")),t.xp6(7),t.hij(" ",t.lcZ(24,25,"actions.view")," "),t.xp6(4),t.hij(" ",t.lcZ(28,27,"actions.update")," "),t.xp6(4),t.hij(" ",t.lcZ(32,29,"actions.delete")," ")}}let J=(()=>{class r{searchForData(){this.selectedBankId&&this.contractService.getData(this.selectedBankId).subscribe(e=>{this.dataTable=e||[],this.checkContractEndDates()})}checkContractEndDates(){this.tableDataHasExpired=[],this.tableDataLessThanMonth=[];const e=new Date;e.setHours(0,0,0,0),this.dataTable.forEach(a=>{const n=new Date(a.contractEndDate);n.setHours(0,0,0,0);const i=12*(n.getFullYear()-e.getFullYear())+(n.getMonth()-e.getMonth()),T=(n.getTime()-e.getTime())/864e5;T>0&&T<=30?this.tableDataLessThanMonth.push(a):i<=0&&this.tableDataHasExpired.push(a)})}isExpired(e){return!!this.tableDataHasExpired&&this.tableDataHasExpired.some(a=>a.contractId===e.contractId)}isLessThanMonth(e){return!!this.tableDataLessThanMonth&&this.tableDataLessThanMonth.some(a=>a.contractId===e.contractId)}openNotificationModal(e){const a=this.modalService.open(L,{backdrop:"static",centered:!0,size:"md"});a.componentInstance.contract=e,a.componentInstance.message=`Contract with start date ${e.contractStartDate} is ending in one month or less!`,a.result.then(n=>{})}constructor(){this.direction="",this.tableDataLessThanMonth=[],this.tableDataHasExpired=[],this.cols=["#","contracts.startDate","contracts.endDate","contracts.contractValue","contracts.atmValue","contracts.description",""],this.listOfBanks=[],this.dataTable=[],this.modalService=(0,t.f3M)(u.FF),this.bankService=(0,t.f3M)(I.y),this.contractService=(0,t.f3M)(C.U),this.selectedBankId=null,this.userData=null,this.userService=(0,t.f3M)(_.K),this.translate=(0,t.f3M)(p.sK),this.userService.getUserData().subscribe(e=>{this.userData=e}),this.getBanks()}ngOnInit(){this.userService.getUserData().subscribe(e=>{this.userData=e})}viewDataTable(e){const a=this.modalService.open(f,{backdrop:"static",centered:!0,size:"lg"});a.componentInstance.title=this.translate.instant("contracts.viewTitle"),a.componentInstance.bankContract=e,a.componentInstance.bankId=this.selectedBankId,a.componentInstance.isView=!0}getBanks(){this.bankService.getData().subscribe(e=>{e&&(this.listOfBanks=e)})}addNew(){const e=this.modalService.open(f,{backdrop:"static",centered:!0,size:"lg"});e.componentInstance.title=this.translate.instant("contracts.addNew"),e.componentInstance.bankId=this.selectedBankId,e.result.then(a=>{a&&this.searchForData()})}onScrollDown(e){this.appendItemsToDataTable(),this.direction="scroll down"}updateDataTable(e){const a=this.modalService.open(f,{backdrop:"static",centered:!0,size:"lg"});a.componentInstance.title=this.translate.instant("contracts.updateTitle"),a.componentInstance.bankContract=e,a.componentInstance.bankId=this.selectedBankId,a.componentInstance.id=e.contractId,a.result.then(n=>{this.searchForData()})}openCofirmDelete(e){this.modalService.open(k.n,{backdrop:"static",centered:!0}).result.then(n=>{n&&(this.deleteData(e),this.translate.get(["ALERTDeletSuccess.TITLE","ALERTDeletSuccess.MESSAGE","ALERTDeletSuccess.SUCCESS"]).subscribe(o=>{w().fire({text:o["ALERTDeletSuccess.MESSAGE"],icon:"success",confirmButtonText:o["ALERTDeletSuccess.SUCCESS"]})}))})}deleteData(e){this.contractService.deleteData(this.userData?this.userData.UserId:0,e).subscribe(a=>{a&&this.searchForData()})}appendItemsToDataTable(){}static#t=this.\u0275fac=function(a){return new(a||r)};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-list-of-contract"]],standalone:!0,features:[t.jDz],decls:27,vars:17,consts:[[1,"row","m-0","pb-3"],[1,"col-9"],[1,"p-2"],[1,"col-3","text-end"],[1,"btn","btn-dark","mt-3",3,"disabled","click"],[1,"col-6"],[1,"p-3",3,"ngSubmit"],["formData","ngForm"],["for","city",1,"required","my-1"],["ngDefaultControl","","bindLabel","banknameL1","bindValue","bankId",3,"clearable","name","items","ngModel","required","searchable","notFoundText","clear","ngModelChange","change",4,"ngIf"],[1,"text-muted"],["infinite-scroll","",1,"search-results-container",3,"scrollWindow","scrolled"],[1,"table","table-responsive","table-striped"],[1,"bg-light","sticky-top","top-0","table-dark"],[1,"bg-dark"],["class","text-center",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["ngDefaultControl","","bindLabel","banknameL1","bindValue","bankId",3,"clearable","name","items","ngModel","required","searchable","notFoundText","clear","ngModelChange","change"],["city","ngModel"],[1,"text-center"],[1,"text-center",3,"ngStyle"],["container","body",1,"text-end",3,"ngStyle"],["container","body",1,"btn-group","me-3"],["ngbDropdown","","role","group","aria-label","Button group with nested dropdown",1,"btn-group"],["ngbDropdownToggle","",1,"fa-solid","fa-list","pointer"],["ngbDropdownMenu","",1,"dropdown-menu"],["ngbDropdownItem","",3,"click"],[1,"fa-solid","fa-eye"],[1,"fa-regular","fa-pen-to-square","text-primary"],[1,"fa-solid","fa-trash","text-danger"]],template:function(a,n){if(1&a){const o=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"div",3)(6,"button",4),t.NdJ("click",function(){return n.addNew()}),t._uU(7),t.ALo(8,"translate"),t.qZA()()(),t.TgZ(9,"div",5)(10,"form",6,7),t.NdJ("ngSubmit",function(){t.CHM(o);const i=t.MAs(11);return t.KtG(i.valid&&n.searchForData())}),t.TgZ(12,"div")(13,"label",8),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.YNc(16,U,3,9,"ng-select",9),t.TgZ(17,"p",10),t._uU(18),t.ALo(19,"translate"),t.qZA()()()(),t.TgZ(20,"div",11),t.NdJ("scrolled",function(i){return n.onScrollDown(i)}),t.TgZ(21,"table",12)(22,"thead",13)(23,"tr",14),t.YNc(24,F,3,3,"th",15),t.qZA()(),t.TgZ(25,"tbody"),t.YNc(26,q,33,45,"tr",16),t.qZA()()()}2&a&&(t.xp6(3),t.Oqu(t.lcZ(4,9,"contracts.title")),t.xp6(3),t.Q6J("disabled",!n.selectedBankId),t.xp6(1),t.hij(" ",t.lcZ(8,11,"contracts.addNew")," "),t.xp6(7),t.Oqu(t.lcZ(15,13,"contracts.selectBank")),t.xp6(2),t.Q6J("ngIf",n.listOfBanks),t.xp6(2),t.Oqu(t.lcZ(19,15,"contracts.selectBankHint")),t.xp6(2),t.Q6J("scrollWindow",!1),t.xp6(4),t.Q6J("ngForOf",n.cols),t.xp6(2),t.Q6J("ngForOf",n.dataTable))},dependencies:[d.ez,d.sg,d.O5,d.PC,d.JJ,d.uU,b.Rq,b.Ry,u.XC,u.jt,u.iD,u.Vi,u.TH,g.A0,g.w9,l.u5,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.On,l.F,p.aw,p.X$]})}return r})()}}]);